<!DOCTYPE html>
<html>
<head>
    <link rel="icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/gamebackup/balatrotest5@refs/heads/main/favicon.ico">
    <style>
    #canvas {
        /* Your existing canvas styles to make it full screen */
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
    }
    
    body {
        /* Your existing body styles */
        width: 100vw;
        height: 100vh;
        margin: 0px;

        /* --- ✨ NEW BACKGROUND STYLES HERE ✨ --- */
        
        /* OPTION 1: Solid Color (e.g., a dark gaming screen color) */
        background-color: #1a1a1a; 
        
        /* OPTION 2: Image Background (Uncomment this and replace URL if needed) */
        /*
        background-image: url('https://example.com/background.jpg');
        background-size: cover; /* Ensures the image covers the whole body */
        background-repeat: no-repeat; /* Prevents tiling */
        background-attachment: fixed; /* Keeps the background static when scrolling (if scrolling were possible) */
        */
        
    }
</style>
    <script>
        const PREFIX = "Balatro_Vanilla_";
        const originalOpen = indexedDB.open;
        const originalDeleteDatabase = indexedDB.deleteDatabase;
        indexedDB.open = function(name, version) {
            const prefixedName = PREFIX + name;
            return version !== undefined ? originalOpen.call(this, prefixedName, version) : originalOpen.call(this, prefixedName);
        };
        indexedDB.deleteDatabase = function(name) {
            const prefixedName = PREFIX + name;
            return originalDeleteDatabase.call(this, prefixedName);
        };
    </script>
    
    <script src="https://cdn.jsdelivr.net/gh/gamebackup/balatrotest5@main/love.min.js"></script>

    <title>Love.js</title>
    <style>
        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
        }
        body {
            width: 100vw;
            height: 100vh;
            margin: 0px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>

    <script>
        const BASE_URL = "https://cdn.jsdelivr.net/gh/gamebackup/balatrotest5@main/";
        const moduleParts = [
            "module.js.part1",
            "module.js.part2",
            "module.js.part3",
            "module.js.part4",
            "module.js.part5",
            "module.js.part6"
        ];

        async function loadAndExecuteModule() {
            let combinedCode = "";

            // Fetch each part sequentially and append its text content
            for (const part of moduleParts) {
                const url = BASE_URL + part; // Since files are in the root, the name is the URL
                try {
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`Failed to load module part: ${url}. Status: ${response.status}`);
                    }
                    const text = await response.text();
                    combinedCode += text; 
                } catch (error) {
                    console.error("Critical Error loading game module:", error);
                    alert("Failed to load game files. Check console for details.");
                    return;
                }
            }

            // Execute the full module code. This defines the 'Module' object globally.
            // This is the functional replacement for the original <script src="module.js">.
            eval(combinedCode); 
            
            // Proceed to the final initialization step.
            runLoveInitialization();
        }
        
        // This function contains the final logic from your original last script tag
        async function runLoveInitialization() {
            // NOTE: getSource() must have been defined in one of the previously loaded scripts (love.min.js or module parts)
            const d = await getSource();
            
            Module = {
                INITIAL_MEMORY: 2**28,
                canvas: canvas,
                printErr: console.error,
                arguments: ["game.love"]
            };
            
            Module.preRun = [function(){
                Module.addRunDependency("fp game.love");
                var ptr = Module.getMemory(d.length);
                Module['HEAPU8'].set(d, ptr);
                Module.FS_createDataFile('/', "game.love", d, true, true, true);
                Module.removeRunDependency("fp game.love");
            }];
            
            // Love() must have been defined by love.min.js
            Love(Module);
        }

        // Start the process when the HTML body loads
        loadAndExecuteModule();

    </script>
    </body>
</html>
